- Goal (incl. success criteria):
  - Add Tesoreria table in Administracion showing rendiciones-linked viaticos (lote, fecha de pago, monto, colaboradores) and display "Enviado a tesoreria" once a rendicion is saved/confirmed.
- Constraints/Assumptions:
  - Follow `AGENTS.md` repo rules and continuity ledger process.
  - Keep changes small; no new dependencies.
  - Use existing Next.js router style, Tailwind, and DB layer in repo.
  - Spanish copy for UI.
- Key decisions:
  - Lote corrections in Pagos y correcciones update the latest version in place (no new version).
  - 0.5 viatico only applies on the last day of a request.
  - Balance adjustments are stored as monetary values at the current viatico rate at time of adjustment.
  - No viatico quantity edits after a request is marked paid.
  - Unused viaticos in rendicion create a DEBIT (saldo deudor) for the collaborator.
- State:
  - Tesoreria table wired to rendiciones data with completion-based filtering and status badge.
- Done:
  - Read `AGENTS.md` and current `CONTINUITY.md`.
  - Added Admin module tab layout and split content by section.
  - Added retroactive apply action and worker balance view in Admin tab.
  - Added rendiciones data model, actions, UI form, and export route.
  - Updated Admin page to await async searchParams.
  - Added Admin payment actions (registrar pago + corregir lote) in Pagos y correcciones.
  - Removed Tesoreria from main navigation and adjusted home/flow messaging.
  - Grouped rendiciones by lote with total amount and workers list in Admin.
  - Added bulk rendition form to apply same data to multiple collaborators.
  - Added Solo pendientes/Todos toggle for bulk rendiciones selection.
  - Added rendicion status filter and removed per-worker forms from rendiciones.
  - Lote corrections now reset status to PENDING_SIGNATURE and remove existing signature.
  - Modals close after actions complete across admin/solicitudes/tesoreria flows.
  - Added modal body scroll and solicitud submission confirmation message.
  - Renamed "Estandarizar" action to "Colocar lote" in Administracion.
  - Removed "Estados clave" and "Base de datos activa" cards from Panel.
  - Renamed Reportes module to Tesoreria in navigation and Admin tab.
  - Updated report exports to Excel-compatible .xls output.
  - Fixed `applyRetroactiveBatch` ledger entries typing to use `BalanceType`.
  - Converted Decimal fields to numbers in Excel export rows.
  - Updated schema to allow decimal days for viaticos and retroactive items.
  - Added last-day half-day toggle in solicitudes wizard and wired to server action.
  - Adjusted request creation to compute fractional viaticos per worker.
  - Updated retroactive day calculation to allow half-day increments.
  - Display retroactive days with decimals in Administracion.
  - Added explicit "Editar fechas" CTA and disabled Next button when step is incomplete in Solicitud wizard.
  - Added consumed viaticos input in rendiciones and persisted it per worker.
  - Added balance ledger adjustments when consumed viaticos are less than available.
  - Switched unused viaticos ledger entries to DEBIT (saldo deudor) on rendicion save.
  - Added success/error notifications for rendicion bulk submit, including saldo deudor notice.
  - Fixed TypeScript null narrowing in rendicion bulk validation.
  - Added Tesoreria table in Administracion to list rendiciones completas by lote.
  - Added "Enviado a tesoreria" badge when rendicion is complete.
  - Migrated RenditionBulkForm to React.useActionState to clear Next warning.
- Now:
  - All requested changes completed; monitoring for follow-up.
- Next:
  - Add filters/export tweaks if requested.
- Open questions (UNCONFIRMED if needed):
- Working set (files/ids/commands):
  - `src/app/administracion/page.tsx`
  - `src/app/actions/renditions.ts`
  - `src/app/administracion/RenditionForm.tsx`




